## Задача 1

Опишите кратко, как вы поняли: в чем основное отличие полной (аппаратной) виртуализации, паравиртуализации и виртуализации на основе ОС.

### Решение
* Полная (аппаратная) виртуализация - гипервизор распологается над аппартными компонентами (устанавливается непосредственно на железо в виде ОС), работает напрямую с железом без посредников. Выполняется полная виртуализация всех компонентов виртуальной машины (CPU, RAM, Disk, NIC), виртуальные машины полностью изолированы. Гостевая ОС "считает", что она работает напрямую с аппаратной частью. 
* Паравиртуализация - гипервизор распологается поверх операционной системой. Работа с железом осуществляется через компоненты операционной системы. При паравиртализации для работы виртуальных машин, модифицируются ядра гостевых ОС. Гостевая ОС "понимает", что она является виртуальной машиной.
* Виртуализация на основе ОС - не требуется гипервизор, все управление осуществляется базовой ОС с помощью механизмов namespace, cgroup и др. Виртуальные машины (контейнеры) при работе используют ядро базовой ОС, поэтому запуск виртуальных машин с другим ядром невозможен

## Задача 2

Выберите один из вариантов использования организации физических серверов, в зависимости от условий использования.

Организация серверов:
- физические сервера,
- паравиртуализация,
- виртуализация уровня ОС.

Условия использования:
- Высоконагруженная база данных, чувствительная к отказу.
- Различные web-приложения.
- Windows системы для использования бухгалтерским отделом.
- Системы, выполняющие высокопроизводительные расчеты на GPU.

Опишите, почему вы выбрали к каждому целевому использованию такую организацию.


### Решение

* Физические сервера:
    > **Высоконагруженная база данных, чувствительная к отказу** - расположение **на физическом сервере** подходит так как требуется высокая производительность и отсутствуют  промежуточные компоненты (напр. гипервизор поверх ОС), которые могут снижать производительность и служить точками отказа. Для данного варианта также подходит расположение на гипервизоре Типа 1 с исполльзованием полной (аппаратной) виртуализации (напр. VMWare vSphere).В виду взаимодействия гипервизора напрямую с железом - производительность будет на высоком уровне, а работа в кластере - позволит достич требуемой отказоустойчивости.
    
    > **Системы, выполняющие высокопроизводительные расчеты на GPU** - подходит вариант работы **на физическом сервере**, так как далеко не все системы виртуализации могут поддерживать родные драйверы GPU, что непосредственно отразится на  возможностях работы GPU и их производительности. Плюс, ранее описанное отсутствие промежуточных компонент, влияющих на снижение производительности. 

* Виртуализация уровня ОС:
    > **Различные web-приложения** - здесь подойдет вариант с использованием **виртуализации на уровне ОС**. При использовании данного подхода, многокомпонентые web- приложения можно оперативно разворачивать в виде контейнеров, и при необходимости добавлять/удалять/перезапускать отдельные контейнеры, что удобно при обновлениях, отказах и т.д.

*  Паравиртуализация:
    >  **Windows системы для использования бухгалтерским отделом** - подходит **паравиртуализация** на базе Hyper-V. Достаточно высокая производительность, возможность бэкапа виртуальной машины, ее состояния и довольно быстрое восстановление.


## Задача 3

Выберите подходящую систему управления виртуализацией для предложенного сценария. Детально опишите ваш выбор.

Сценарии:

1. 100 виртуальных машин на базе Linux и Windows, общие задачи, нет особых требований. Преимущественно Windows based инфраструктура, требуется реализация программных балансировщиков нагрузки, репликации данных и автоматизированного механизма создания резервных копий.
2. Требуется наиболее производительное бесплатное open source решение для виртуализации небольшой (20-30 серверов) инфраструктуры на базе Linux и Windows виртуальных машин.
3. Необходимо бесплатное, максимально совместимое и производительное решение для виртуализации Windows инфраструктуры.
4. Необходимо рабочее окружение для тестирования программного продукта на нескольких дистрибутивах Linux.


### Решение


1. 100 виртуальных машин на базе Linux и Windows, общие задачи, нет особых требований. Преимущественно Windows based инфраструктура, требуется реализация программных балансировщиков нагрузки, репликации данных и автоматизированного механизма создания резервных копий.
    > В виду того, используется довольно большое количество виртуальных машин разного типа и требуется реализация программных балансировщиков нагрузки, репликации данных и автоматического создания резервных копий, и в тоже время не рассматривается вопрос экономии средств - для данного сценария подойдет **VMWare vSphere**. Полная аппаратная виртуализация позволит достичь высокой производительности любой гостевой ОС будь то Linux, либо Windows. Механизмы VMware DRS, vSphere Replication, vSphere vMotion и  vCenter Server Appliance - позволят балансировать нагрузку, выполнять репликацию и миграцию работающих ВМ, а также выполнять автоматическое резервное копирование.
2. Требуется наиболее производительное бесплатное open source решение для виртуализации небольшой (20-30 серверов) инфраструктуры на базе Linux и Windows виртуальных машин.
    > По причине необходимости использования ОС Linux и Windows одновременно, относительно небольшого парка серверов, а также учитывая то, что решение должно быть бесплатным и open source - подойдет **KVM**. KVM отлично работает с Linux, но в тоже время позволяет запускать Windows с хорошей производительностью.
3. Необходимо бесплатное, максимально совместимое и производительное решение для виртуализации Windows инфраструктуры.
    > В данном сценарии подойдет **Hyper-V** - входит в состав, Windows Server. Таким образом при покупке Windows Server вы не платите за Hyper-V. При этом Hyper-V - единственный гипервизор, который максимально совместим и производителен при виртуализации Windows инфраструктуры (ОС и гипервизор разработаны одной компанией, а в виду того, что Windows не open source и доступ к коду ОС для остальных закрыт, кроме Microsoft никто не сможет сделать гипервизор для Windows лучше)
4. Необходимо рабочее окружение для тестирования программного продукта на нескольких дистрибутивах Linux.
    > В данном сценарии подойдет связка Vagrant+VirtualBox (либо vagrant c другим провайдером) - так как vagrant обеспечивает быстрое развертывание тестовых сред. При описании конфигурации в Vagrantfile, для каждой создаваемой ВМ, можно указать отдельные vm.box (например CentOS и Ubuntu), что позволит быстро развернуть разные дистрибутивы Linux.

## Задача 4

Опишите возможные проблемы и недостатки гетерогенной среды виртуализации (использования нескольких систем управления виртуализацией одновременно) и что необходимо сделать для минимизации этих рисков и проблем. Если бы у вас был выбор, то создавали бы вы гетерогенную среду или нет? Мотивируйте ваш ответ примерами.


### Решение
- Возможные проблемы и недостатки гетерогенной среды виртуализации
    * Нет единого инструмента управления виртуальной инфраструктурой. 
    * При необходимости обеспечения отказоустойчивости в двух средах виртуализации, потребуется гораздо больше серверных мощностей (например в рамках единой среды - мы организовываем кластер из 2х гипервизоров, а для двух разных сред, потребуется как минимум по два для каждой)
    * Сложности при  миграции, либо полное отсутствие возможности миграции из одной среды в другую.
    * Помимо содержания "задвоенной" инфраструктуры, возможны дополнительные финансовые расходы, на содержание двух сред виртуализации, связанные с вопросами лицензирования и кадрами (возможна ситуация когда невозможно обойтись без отдельного инженера, обслуживающего конкретную среду, в силу её специфичности).
- Что необходимо сделать для минимизации этих рисков и проблем:
    * Выполнить аналитику решений на рынке, оценить возможности собственной инфраструктуры и отталкиваясь от требований бизнеса и финансовых возможностей, выполнить миграцию инфраструктуры на единую платформу виртуализации. Если это невозможно, определить какие сервисы наиболее критичны, вложить средства в одну из платформ виртуализации, которая отвечает вопросам производительсности и отказоустойчивости (создать кластер и т.д.) и постепенно мигрировать на неё важные виртуальные машины. Оставить во второй среде виртуализации не критичные для бизнеса сервисы, не тратить ресурсы на поддержание отказоустойчивой инфраструктуры. Реорганизовать высвободившиеся серверные мощности. Такие меры со временем позволят сократить финансовые расходы на содержание задвоенной виртуальной инфраструктуры и остальные вопросы связанные с кадрами и лицензированием.
